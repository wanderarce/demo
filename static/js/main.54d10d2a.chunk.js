(this["webpackJsonpsigma-demo"]=this["webpackJsonpsigma-demo"]||[]).push([[0],{42:function(e,t,c){},91:function(e,t,c){"use strict";c.r(t);var n=c(2),a=c.n(n),s=c(34),r=c.n(s),o=(c(42),c(13)),i=c(3),l=c(5),u=c(6),j=c(35),b=c.n(j),d=c(4),O="#000000";function h(e,t,c){if(t.label){var n=c.labelSize,a=c.labelFont,s=c.labelWeight;e.font="".concat(s," ").concat(n,"px ").concat(a);var r=e.measureText(t.label).width+8;e.fillStyle="#ffffffcc",e.fillRect(t.x+t.size,t.y+n/3-15,r,20),e.fillStyle="#000",e.fillText(t.label,t.x+t.size+3,t.y+n/3)}}var f=function(e,t){var c=Object(n.useState)(e),a=Object(l.a)(c,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){var c=setTimeout((function(){e!==s&&r(e)}),t);return function(){clearTimeout(c)}}),[e,t]),s},m=c(1),x=function(e){var t=e.children,c=e.hoveredNode,a=Object(u.useSigma)(),s=a.getGraph(),r=f(c,40);return Object(n.useEffect)((function(){a.setSetting("hoverRenderer",(function(e,t,c){return function(e,t,c){var n=c.labelSize,a=c.labelFont,s=c.labelWeight,r=n-2,o=t.label,i="unknown"!==t.tag?t.tag:"",l=t.clusterLabel;e.beginPath(),e.fillStyle="#fff",e.shadowOffsetX=0,e.shadowOffsetY=2,e.shadowBlur=8,e.shadowColor="#000",e.font="".concat(s," ").concat(n,"px ").concat(a);var u=e.measureText(o).width;e.font="".concat(s," ").concat(r,"px ").concat(a);var j=i?e.measureText(i).width:0;e.font="".concat(s," ").concat(r,"px ").concat(a);var b=l?e.measureText(l).width:0,d=Math.max(u,j,b),h=Math.round(t.x),f=Math.round(t.y),m=Math.round(d+n/2+t.size+3),x=Math.round(n/2+4),g=i?Math.round(r/2+9):0;!function(e,t,c,n,a,s){e.beginPath(),e.moveTo(t+s,c),e.lineTo(t+n-s,c),e.quadraticCurveTo(t+n,c,t+n,c+s),e.lineTo(t+n,c+a-s),e.quadraticCurveTo(t+n,c+a,t+n-s,c+a),e.lineTo(t+s,c+a),e.quadraticCurveTo(t,c+a,t,c+a-s),e.lineTo(t,c+s),e.quadraticCurveTo(t,c,t+s,c),e.closePath()}(e,h,f-g-12,m,Math.round(r/2+9)+x+g+12,5),e.closePath(),e.fill(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.fillStyle=O,e.font="".concat(s," ").concat(n,"px ").concat(a),e.fillText(o,t.x+t.size+3,t.y+n/3),i&&(e.fillStyle=O,e.font="".concat(s," ").concat(r,"px ").concat(a),e.fillText(i,t.x+t.size+3,t.y-2*n/3-2)),e.fillStyle=t.color,e.font="".concat(s," ").concat(r,"px ").concat(a),e.fillText(l,t.x+t.size+3,t.y+n/3+3+r)}(e,Object(i.a)(Object(i.a)({},a.getNodeDisplayData(t.key)),t),c)}))}),[a,s]),Object(n.useEffect)((function(){var e=r?a.getNodeDisplayData(r).color:"";a.setSetting("nodeReducer",r?function(e,t){return e===r||s.hasEdge(e,r)||s.hasEdge(r,e)?Object(i.a)(Object(i.a)({},t),{},{zIndex:1}):Object(i.a)(Object(i.a)({},t),{},{zIndex:0,label:"",color:"#ccc",image:null,highlighted:!1})}:null),a.setSetting("edgeReducer",r?function(t,c){return s.hasExtremity(t,r)?Object(i.a)(Object(i.a)({},c),{},{color:e,size:4}):Object(i.a)(Object(i.a)({},c),{},{color:"#eee",hidden:!0})}:null)}),[r]),Object(m.jsx)(m.Fragment,{children:t})};var g=function(e){var t=e.setHoveredNode,c=e.children,a=Object(u.useSigma)().getGraph(),s=Object(u.useRegisterEvents)();return Object(n.useEffect)((function(){s({clickNode:function(e){var c=e.node;t(c),a.getNodeAttribute(c,"hidden")}})}),[]),Object(m.jsx)(m.Fragment,{children:c})},p=c(9),y=function(e){var t=e.dataset,c=e.filters,a=e.children,s=Object(u.useSigma)().getGraph();return Object(n.useEffect)((function(){if(s&&t){var e=Object(d.keyBy)(t.clusters,"key"),c=Object(d.keyBy)(t.tags,"key");t.nodes.forEach((function(t){return s.addNode(t.key,Object(i.a)(Object(i.a)(Object(i.a)({},t),Object(d.omit)(e[t.cluster],"key")),{},{image:"".concat("/demo","/images/").concat(c[t.tag].image)}))})),t.edges.forEach((function(e){var t=e.edge;s.addEdge(t[0],t[1],{size:.5})}));var n=s.nodes().map((function(e){return s.getNodeAttribute(e,"score")})),a=Math.min.apply(Math,Object(p.a)(n)),r=Math.max.apply(Math,Object(p.a)(n));return s.forEachNode((function(e){return s.setNodeAttribute(e,"size",(s.getNodeAttribute(e,"score")-a)/(r-a)*27+3)})),function(){return s.clear()}}}),[s,t]),Object(n.useEffect)((function(){var e=c.clusters,t=c.tags;s.forEachNode((function(c,n){var a=n.cluster,r=n.tag;s.setNodeAttribute(c,"hidden",!e[a]||!t[r])}))}),[s,c]),Object(m.jsx)(m.Fragment,{children:a})},v=c(8),k=c(36),N=c.n(k),S=function(e){var t=e.title,c=e.initiallyDeployed,a=e.children,s=Object(n.useState)(c||!1),r=Object(l.a)(s,2),o=r[0],i=r[1],u=Object(n.useRef)(null);return Object(n.useEffect)((function(){o&&setTimeout((function(){u.current&&u.current.parentElement.scrollTo({top:u.current.offsetTop-5,behavior:"smooth"})}),300)}),[o]),Object(m.jsxs)("div",{className:"panel",ref:u,children:[Object(m.jsxs)("h2",{children:[t," ",Object(m.jsx)("button",{type:"button",onClick:function(){return i((function(e){return!e}))},children:o?Object(m.jsx)(v.b,{}):Object(m.jsx)(v.c,{})})]}),Object(m.jsx)(N.a,{duration:300,height:o?"auto":0,children:a})]})},C=c(92),E=function(e){var t=e.clusters,c=e.filters,a=e.toggleCluster,s=e.setClusters,r=Object(u.useSigma)().getGraph(),o=Object(n.useMemo)((function(){var e={};return r.forEachNode((function(t,c){var n=c.cluster;return e[n]=(e[n]||0)+1})),e}),[]),i=Object(n.useMemo)((function(){return Math.max.apply(Math,Object(p.a)(Object(d.values)(o)))}),[o]),j=Object(n.useMemo)((function(){return Object.keys(c.clusters).length}),[c]),b=Object(n.useState)(o),O=Object(l.a)(b,2),h=O[0],f=O[1];Object(n.useEffect)((function(){requestAnimationFrame((function(){var e={};r.forEachNode((function(t,c){var n=c.cluster;return!c.hidden&&(e[n]=(e[n]||0)+1)})),f(e)}))}),[c]);var x=Object(n.useMemo)((function(){return Object(d.sortBy)(t,(function(e){return-o[e.key]}))}),[t,o]);return Object(m.jsxs)(S,{title:Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v.d,{className:"text-muted"})," Clusters",j<t.length?Object(m.jsxs)("span",{className:"text-muted text-small",children:[" ","(",j," / ",t.length,")"]}):""]}),children:[Object(m.jsx)("p",{children:Object(m.jsx)("i",{className:"text-muted",children:"Click a cluster to show/hide related pages from the network."})}),Object(m.jsxs)("p",{className:"buttons",children:[Object(m.jsxs)("button",{className:"btn",onClick:function(){return s(Object(d.mapValues)(Object(d.keyBy)(t,"key"),(function(){return!0})))},children:[Object(m.jsx)(C.a,{})," Check all"]})," ",Object(m.jsxs)("button",{className:"btn",onClick:function(){return s({})},children:[Object(m.jsx)(C.b,{})," Uncheck all"]})]}),Object(m.jsx)("ul",{children:x.map((function(e){var t=o[e.key],n=h[e.key]||0;return Object(m.jsxs)("li",{className:"caption-row",title:"".concat(t," page").concat(t>1?"s":"").concat(n!==t?" (only ".concat(n," visible)"):""),children:[Object(m.jsx)("input",{type:"checkbox",checked:c.clusters[e.key]||!1,onChange:function(){return a(e.key)},id:"cluster-".concat(e.key)}),Object(m.jsxs)("label",{htmlFor:"cluster-".concat(e.key),children:[Object(m.jsx)("span",{className:"circle",style:{background:e.color,borderColor:e.color}})," ",Object(m.jsxs)("div",{className:"node-label",children:[Object(m.jsx)("span",{children:e.clusterLabel}),Object(m.jsx)("div",{className:"bar",style:{width:100*t/i+"%"},children:Object(m.jsx)("div",{className:"inside-bar",style:{width:100*n/t+"%"}})})]})]})]},e.key)}))})]})},w=c(10),T=function(e){var t=e.setHoveredNode,c=e.filters,a=Object(u.useSigma)(),s=Object(n.useState)(""),r=Object(l.a)(s,2),o=r[0],j=r[1],b=Object(n.useState)([]),d=Object(l.a)(b,2),O=d[0],h=d[1],f=Object(n.useState)(null),x=Object(l.a)(f,2),g=x[0],p=x[1],y=function(){var e=[],t=o.toLowerCase();!g&&o.length>3&&a.getGraph().forEachNode((function(c,n){n.hidden&&(n.color="#ccc"),!n.hidden&&n.label&&0===n.label.toLowerCase().indexOf(t)&&e.push({id:c,label:n.label})})),h(e)};Object(n.useEffect)((function(){return y()}),[o]),Object(n.useEffect)((function(){requestAnimationFrame(y)}),[c]),Object(n.useEffect)((function(){if(g){a.getGraph().setNodeAttribute(g,"highlighted",!0);var e=a.getNodeDisplayData(g);return g&&t(g),console.log(g),e&&a.getCamera().animate(Object(i.a)(Object(i.a)({},e),{},{ratio:.05}),{duration:600}),function(){a.getGraph().setNodeAttribute(g,"highlighted",!1)}}t("")}),[g]);return Object(m.jsxs)("div",{className:"search-wrapper",children:[Object(m.jsx)("input",{type:"search",placeholder:"Search in nodes...",list:"nodes",value:o,id:"search",onChange:function(e){var t=e.target.value,c=O.find((function(e){return e.label===t}));c?(j(c.label),h([]),p(c.id)):(p(null),j(t))},onKeyPress:function(e){"Enter"===e.key&&O.length&&(j(O[0].label),p(O[0].id))}}),Object(m.jsx)(w.c,{className:"icon",onClick:function(e){j("")}}),Object(m.jsx)("datalist",{id:"nodes",children:O.map((function(e){return Object(m.jsx)("option",{value:e.label,children:e.label},e.id)}))})]})};function M(e){return(100*e).toFixed(1)+"%"}var z=function(e){var t=e.filters,c=Object(u.useSigma)().getGraph(),a=Object(n.useState)({nodes:0,edges:0}),s=Object(l.a)(a,2),r=s[0],o=s[1];return Object(n.useEffect)((function(){requestAnimationFrame((function(){var e={nodes:0,edges:0};c.forEachNode((function(t,c){return!c.hidden&&e.nodes++})),c.forEachEdge((function(t,c,n,a,s,r){return!s.hidden&&!r.hidden&&e.edges++})),o(e)}))}),[t]),Object(m.jsxs)("div",{className:"graph-title",children:[Object(m.jsx)("h1",{children:"A cartography of Wikipedia pages around data visualization"}),Object(m.jsx)("h2",{children:Object(m.jsxs)("i",{children:[c.order," node",c.order>1?"s":""," ",r.nodes!==c.order?" (only ".concat(M(r.nodes/c.order)," visible)"):"",", ",c.size," edge",c.size>1?"s":""," ",r.edges!==c.size?" (only ".concat(M(r.edges/c.size)," visible)"):""]})})]})},F=function(e){var t=e.tags,c=e.filters,a=e.toggleTag,s=e.setTags,r=Object(u.useSigma)().getGraph(),o=Object(n.useMemo)((function(){var e={};return r.forEachNode((function(t,c){var n=c.tag;return e[n]=(e[n]||0)+1})),e}),[]),i=Object(n.useMemo)((function(){return Math.max.apply(Math,Object(p.a)(Object(d.values)(o)))}),[o]),j=Object(n.useMemo)((function(){return Object.keys(c.tags).length}),[c]),b=Object(n.useState)(o),O=Object(l.a)(b,2),h=O[0],f=O[1];Object(n.useEffect)((function(){requestAnimationFrame((function(){var e={};r.forEachNode((function(t,c){var n=c.tag;return!c.hidden&&(e[n]=(e[n]||0)+1)})),f(e)}))}),[c]);var x=Object(n.useMemo)((function(){return Object(d.sortBy)(t,(function(e){return"unknown"===e.key?1/0:-o[e.key]}))}),[t,o]);return Object(m.jsxs)(S,{title:Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v.a,{className:"text"})," Companies",j<t.length?Object(m.jsxs)("span",{className:"text-muted text-small",children:[" ","(",j," / ",t.length,")"]}):""]}),children:[Object(m.jsx)("p",{children:Object(m.jsx)("i",{className:"text-muted",children:"Click a company to show/hide related pages from the network."})}),Object(m.jsxs)("p",{className:"buttons",children:[Object(m.jsxs)("button",{className:"btn",onClick:function(){return s(Object(d.mapValues)(Object(d.keyBy)(t,"key"),(function(){return!0})))},children:[Object(m.jsx)(C.a,{})," Check all"]})," ",Object(m.jsxs)("button",{className:"btn",onClick:function(){return s({})},children:[Object(m.jsx)(C.b,{})," Uncheck all"]})]}),Object(m.jsx)("ul",{children:x.map((function(e){var t=o[e.key],n=h[e.key]||0;return Object(m.jsxs)("li",{className:"caption-row",title:"".concat(t," page").concat(t>1?"s":"").concat(n!==t?" (only ".concat(n," visible)"):""),children:[Object(m.jsx)("input",{type:"checkbox",checked:c.tags[e.key]||!1,onChange:function(){return a(e.key)},id:"tag-".concat(e.key)}),Object(m.jsxs)("label",{htmlFor:"tag-".concat(e.key),children:[Object(m.jsx)("span",{className:"circle",style:{backgroundImage:"url(".concat("/demo","/images/").concat(e.image,")")}})," ",Object(m.jsxs)("div",{className:"node-label",children:[Object(m.jsx)("span",{children:e.key}),Object(m.jsx)("div",{className:"bar",style:{width:100*t/i+"%"},children:Object(m.jsx)("div",{className:"inside-bar",style:{width:100*n/t+"%"}})})]})]})]},e.key)}))})]})},A=(c(90),c(18)),B=c(23),G=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(!1),r=Object(l.a)(s,2),j=r[0],O=r[1],f=Object(n.useState)(null),p=Object(l.a)(f,2),v=p[0],k=p[1],N=Object(n.useState)({clusters:{},tags:{},nodes:{}}),S=Object(l.a)(N,2),C=S[0],M=S[1],G=Object(n.useState)(null),q=Object(l.a)(G,2),R=q[0],D=q[1];return Object(n.useEffect)((function(){fetch("".concat("/demo","/dataset.json")).then((function(e){return e.json()})).then((function(e){k(e),M({clusters:Object(d.mapValues)(Object(d.keyBy)(e.clusters,"key"),Object(d.constant)(!0)),tags:Object(d.mapValues)(Object(d.keyBy)(e.tags,"key"),Object(d.constant)(!0)),nodes:Object(d.mapValues)(Object(d.keyBy)(e.nodes,"key"),Object(d.constant)(!0))}),requestAnimationFrame((function(){return O(!0)}))}))}),[]),v?Object(m.jsx)("div",{id:"app-root",className:c?"show-contents":"",children:Object(m.jsxs)(u.SigmaContainer,{graphOptions:{type:"directed"},initialSettings:{nodeProgramClasses:{image:b()()},labelRenderer:h,defaultNodeType:"image",defaultEdgeType:"arrow",labelDensity:.07,labelGridCellSize:60,labelRenderedSizeThreshold:15,labelFont:"Lato, sans-serif",zIndex:!0},className:"react-sigma",children:[Object(m.jsx)(x,{hoveredNode:R}),Object(m.jsx)(g,{setHoveredNode:D}),Object(m.jsx)(y,{dataset:v,filters:C}),j&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"controls",children:[Object(m.jsx)("div",{className:"ico",children:Object(m.jsx)("button",{type:"button",className:"show-contents",onClick:function(){return a(!0)},title:"Show caption and description",children:Object(m.jsx)(B.a,{})})}),Object(m.jsx)(u.FullScreenControl,{className:"ico",customEnterFullScreen:Object(m.jsx)(w.a,{}),customExitFullScreen:Object(m.jsx)(w.b,{})}),Object(m.jsx)(u.ZoomControl,{className:"ico",customZoomIn:Object(m.jsx)(w.d,{}),customZoomOut:Object(m.jsx)(w.e,{}),customZoomCenter:Object(m.jsx)(B.b,{})}),Object(m.jsx)("div",{className:"ico",children:Object(m.jsx)("button",{type:"button",className:"",onClick:function(){return D("")},title:"Reset Filters",children:Object(m.jsx)(A.b,{})})})]}),Object(m.jsxs)("div",{className:"contents",children:[Object(m.jsx)("div",{className:"ico",children:Object(m.jsx)("button",{type:"button",className:"ico hide-contents",onClick:function(){return a(!1)},title:"Show caption and description",children:Object(m.jsx)(A.a,{})})}),Object(m.jsx)("div",{className:"ico",children:Object(m.jsx)("button",{type:"button",className:"ico hide-contents",onClick:function(){return a(!1)},title:"Show caption and description",children:Object(m.jsx)(A.a,{})})}),Object(m.jsx)(z,{filters:C}),Object(m.jsxs)("div",{className:"panels",children:[Object(m.jsx)(T,{setHoveredNode:D,filters:C}),Object(m.jsx)(E,{clusters:v.clusters,filters:C,setClusters:function(e){return M((function(t){return Object(i.a)(Object(i.a)({},t),{},{clusters:e})}))},toggleCluster:function(e){M((function(t){return Object(i.a)(Object(i.a)({},t),{},{clusters:t.clusters[e]?Object(d.omit)(t.clusters,e):Object(i.a)(Object(i.a)({},t.clusters),{},Object(o.a)({},e,!0))})}))}}),Object(m.jsx)(F,{tags:v.tags,filters:C,setTags:function(e){return M((function(t){return Object(i.a)(Object(i.a)({},t),{},{tags:e})}))},toggleTag:function(e){M((function(t){return Object(i.a)(Object(i.a)({},t),{},{tags:t.tags[e]?Object(d.omit)(t.tags,e):Object(i.a)(Object(i.a)({},t.tags),{},Object(o.a)({},e,!0))})}))}})]})]})]})]})}):null};r.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(G,{})}),document.getElementById("root"))}},[[91,1,2]]]);
//# sourceMappingURL=main.54d10d2a.chunk.js.map